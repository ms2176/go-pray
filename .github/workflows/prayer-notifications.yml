name: Prayer Time Notifications

on:
  schedule:
    # Run every 5 minutes (adjust as needed)
    # This ensures we catch prayer times within a 5-minute window
    - cron: '*/5 * * * *'
  
  # Allow manual triggering from GitHub UI
  workflow_dispatch:

jobs:
  check-prayer-times:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v3
    
    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'
    
    - name: Install dependencies
      run: |
        pip install requests
    
    - name: Check prayer times and send notifications
      env:
        NTFY_TOPIC: ${{ secrets.NTFY_TOPIC }}
        LATITUDE: ${{ secrets.LATITUDE }}
        LONGITUDE: ${{ secrets.LONGITUDE }}
        CALCULATION_METHOD: ${{ secrets.CALCULATION_METHOD }}
      run: |
        python check_prayer_times.py
